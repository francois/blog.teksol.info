--- 
title:      "Rails Helpers and Instance Variables"
created_at: 2005-11-10 16:39:00
blog_post:  true
filter:
  - erb
  - textile
--- 
I was reading the code for the "FileColumn":http://www.kanthak.net/opensource/file_column/, helper and I had a thought.  What if we could obviate the need for requiring instance variables for helpers ?

A recent example on the mailing list ?  "render partial and passing in the object":http://thread.gmane.org/gmane.comp.lang.ruby.rails/28873, by Mark Van Holstyn.  In the thread, he asks why he can't do:

<textarea name="code" cols="55" rows="15" class="ruby" title="app/controllers/user_controller.rb">def edit
  @user = User.find_by_id(1)
  render :partial => 'address', :object => @user.address}
end
</textarea>

His partial being:
<textarea name="code" cols="55" rows="15" title="app/views/shared/_address.rhtml" class="rhtml"><%= text_area('address', 'street') %>
</textarea>

Reading FileColumn helper's code, and the code in Rails own helpers, the following idiom is used to get a hold of the instance variable:
<textarea name="code" cols="55" rows="15" class="ruby" title="file-column-0.3/lib/file_column_helper.rb">def url_for_file_column(object_name, method, suffix=nil)
  object = instance_variable_get("@#{object_name.to_s}")
  ...
end
</textarea>

What if we did it this way instead ?

<textarea name="code" cols="55" rows="15" class="ruby" title="file-column-0.3x/lib/file_column_helper.rb">def url_for_file_column(object_name, method, suffix=nil)
  object =  case object_name
            when String, Symbol
              instance_variable_get("@#{object_name.to_s}")
            else
              object_name
            end
  ...
end
</textarea>

Actually, this should all be abstracted away in some kind of helper for helpers.  Let me take a moment to prepare a patch.  I think this would make things quite a bit easier for partial users.